{"version":3,"sources":["../src/transparent-checkout.js"],"names":["require","$","on","couponcode","data","val","createMasks","document","ccCieloValidateFields","urlParams","URLSearchParams","window","location","search","get","submit","cep","replace","test","getJSON","dados","logradouro","bairro","localidade","uf","ibge","limpa_formulário_cep","alert","mask","onKeyPress","ph","e","field","ph_options","masks","length","doc","options","limpa_formulário_cep_boleto","rtn","html","trim","console","log"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Potential user selector module.\n *\n * @module     enrol_manual/form-potential-user-selector\n * @class      form-potential-user-selector\n * @package    enrol_manual\n * @copyright  2016 Damyon Wiese\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nrequire(['jquery'], function($){\n\n    $(\"#cielo-payment-btn\").on('click', function(){\n        var couponcode = $(\"#cielo-payment-btn\").data('coupon-code');\n        $('#cc_couponcode').val(couponcode);\n        createMasks();\n    });\n\n    $(document).on('click', '#cc_cielo_submit', function() {\n        if(ccCieloValidateFields()){\n            var urlParams = new URLSearchParams(window.location.search);\n            $(\"#cc_courseid\").val(urlParams.get('id'));\n            $('#cielo_cc_form').submit();\n        }\n    });\n    \n    $(document).on('click', '#boleto_cielo_submit', function() {\n        if(ccCieloValidateFields()){\n            var urlParams = new URLSearchParams(window.location.search);\n            $(\"#boleto_courseid\").val(urlParams.get('id'));\n            $('#cielo_boleto_form').submit();\n        }\n    });\n\n    $(document).on('focusout', '#billingpostcode', function() {\n        var cep = $('#billingpostcode').val().replace(/\\D/g, '');\n        // Verifica se campo cep possui valor informado.\n        if (cep != \"\") {\n            // Expressão regular para validar o CEP.\n            var validacep = /^[0-9]{8}$/;\n            // Valida o formato do CEP.\n            if(validacep.test(cep)) {\n                // Preenche os campos com \"...\" enquanto consulta webservice.\n                $(\"#billingstreet\").val(\"...\");\n                $(\"#billingdistrict\").val(\"...\");\n                $(\"#billingcity\").val(\"...\");\n                $(\"#billingstate\").val(\"...\");\n                $(\"#ibge\").val(\"...\");\n                // Consulta o webservice viacep.com.br.\n                $.getJSON(\"https://viacep.com.br/ws/\" + cep + \"/json/?callback=?\", function(dados) {\n                    if (!(\"erro\" in dados)) {\n                        // Atualiza os campos com os valores da consulta.\n                        $(\"#billingstreet\").val(dados.logradouro);\n                        $(\"#billingdistrict\").val(dados.bairro);\n                        $(\"#billingcity\").val(dados.localidade);\n                        $(\"#billingstate\").val(dados.uf);\n                        $(\"#ibge\").val(dados.ibge);\n                    } else {\n                        // CEP pesquisado não foi encontrado.\n                        limpa_formulário_cep();\n                        alert(\"CEP não encontrado.\");\n                    }\n                });\n            } else {\n                limpa_formulário_cep();\n                alert(\"Formato de CEP inválido.\");\n            }\n        } else {\n            // Cep sem valor, limpa formulário.\n            limpa_formulário_cep();\n        }\n    });\n    \n    $(document).on('focusout', '#boletocep', function() {\n        var cep = $('#boletocep').val().replace(/\\D/g, '');\n        // Verifica se campo cep possui valor informado.\n        if (cep != \"\") {\n            // Expressão regular para validar o CEP.\n            var validacep = /^[0-9]{8}$/;\n            // Valida o formato do CEP.\n            if(validacep.test(cep)) {\n                // Preenche os campos com \"...\" enquanto consulta webservice.\n                $(\"#boletologradouro\").val(\"...\");\n                $(\"#boletobairro\").val(\"...\");\n                $(\"#boletocidade\").val(\"...\");\n                $(\"#boletouf\").val(\"...\");\n                // Consulta o webservice viacep.com.br.\n                $.getJSON(\"https://viacep.com.br/ws/\" + cep + \"/json/?callback=?\", function(dados) {\n                    if (!(\"erro\" in dados)) {\n                        // Atualiza os campos com os valores da consulta.\n                        $(\"#boletologradouro\").val(dados.logradouro);\n                        $(\"#boletobairro\").val(dados.bairro);\n                        $(\"#boletocidade\").val(dados.localidade);\n                        $(\"#boletouf\").val(dados.uf);\n                    } else {\n                        // CEP pesquisado não foi encontrado.\n                        limpa_formulário_cep();\n                        alert(\"CEP não encontrado.\");\n                    }\n                });\n            } else {\n                limpa_formulário_cep();\n                alert(\"Formato de CEP inválido.\");\n            }\n        } else {\n            // Cep sem valor, limpa formulário.\n            limpa_formulário_cep();\n        }\n    });\n});\n\nfunction createMasks(){\n    require(['jquery', 'enrol_cielo/jqmask'], function($, jqmask){\n        var ph_options = {\n            onKeyPress: function(ph, e, field, ph_options){\n                var masks = ['(00) 0000-00009', '(00) 0 0000-0000'];\n                var mask = (ph.length > 14) ? masks[1] : masks [0];\n                $('.input-phone').mask(mask, ph_options);\n            }\n        };\n        $('.input-phone').mask(\"(00) 0000-0000\", ph_options);\n        var options = {\n            onKeyPress: function(doc, e, field, options){\n                var masks = ['000.000.000-009', '00.000.000/0000-00'];\n                var mask = (doc.length > 14) ? masks[1] : masks [0];\n                $('.input-cpfcnpj').mask(mask, options);\n            }\n        };\n        $('.input-cpfcnpj').mask(\"000.000.000-009\", options);\n        $('.input-ccnumber').mask('0000 0000 0000 0000');\n        $('.input-ccvalid').mask('00/0000');\n        $('.input-cvv').mask('000');\n    });\n}\n\nfunction limpa_formulário_cep() {\n    // Limpa valores do formulário de cep.\n    require(['jquery'],function($){\n        $(\"#billingstreet\").val(\"\");\n        $(\"#billingdistrict\").val(\"\");\n        $(\"#billingcity\").val(\"\");\n        $(\"#billingstate\").val(\"\");\n    });\n}\n\nfunction limpa_formulário_cep_boleto() {\n    // Limpa valores do formulário de cep.\n    require(['jquery'],function($){\n        $(\"#boletologradouro\").val(\"\");\n        $(\"#boletobairro\").val(\"\");\n        $(\"#boletocidade\").val(\"\");\n        $(\"#boletouf\").val(\"\");\n    });\n}\n\nfunction ccCieloValidateFields(){\n    \n    var rtn = true;\n    require(['jquery'],function($) {\n        var re_ccvalid = /\\d{2}\\/\\d{4}/gm;\n        var re_ccNumber = /\\d{4}(\\s\\d{4}){3}/gm;\n        var re_cccvv = /\\d{3}/gm;\n        if(!$('input[name=ccbrand]:checked', '#cielo_cc_form').val()){\n            rtn = false;\n            $(\"#ccBrand-error\").html('Favor escolher bandeira do cartão');\n        } else{\n            $(\"#ccBrand-error\").html('');\n        }\n        if(!$(\"#ccName\").val().trim()){\n            rtn = false;\n            $(\"#ccName-error\").html('Favor preencher Nome corretamente');\n        }else{\n            $(\"#ccName-error\").html('');\n        }\n        if(!re_ccNumber.test($(\"#ccNumber\").val().trim())){\n            rtn = false;\n            $(\"#ccNumber-error\").html('Favor preencher Número do cartão corretamente');\n        }else{\n            $(\"#ccNumber-error\").html('');\n        }\n        if(!re_ccvalid.test($(\"#ccvalid\").val().trim())){\n            console.log(\"reached here\");\n            rtn = false;\n            $(\"#ccvalid-error\").html('Favor preencher Validade do cartão corretamente mm/aaaa');\n        }else{\n            $(\"#ccvalid-error\").html('');\n        }\n        if(!re_cccvv.test($(\"#cvv\").val().trim())){\n            rtn = false;\n            $(\"#cvv-error\").html('Favor preencher CVV corretamente');\n        }else{\n            $(\"#cvv-error\").html('');\n        }\n    });\n\n    return rtn;\n}\n"],"file":"transparent-checkout.min.js"}